local player = game.Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local mapIDs = {86392425558311, 80299472659017, 120958789962854, 76011326497329, 110577167676254} -- map IDs ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ü‡∏≤‡∏£‡πå‡∏°
local safeZonePosition = CFrame.new(467.62384033203125, 315.87823486328125, -109.36079406738281)

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
local function checkPlayerAndPetReady()
    while true do
        -- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô
        local character = player.Character
        local pet = character and character:FindFirstChild("HumanoidRootPart") and character.HumanoidRootPart:FindFirstChild("pet1")

        if character and pet then
            print("‚úî ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå...")
            return true -- ‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå
        end

        -- ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏≠ 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏´‡∏°‡πà
        wait(1)
    end
end

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ Map ID
local function checkMapID()
    local currentMapID = game.PlaceId
    for _, id in ipairs(mapIDs) do
        if currentMapID == id then
            return true
        end
    end
    return false
end

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á
local function checkNearbyPlayers()
    local detectionRadius = 10000
    local excludedPlayers = {"zMaxikax", "DarkFalcon_Z"}

    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and not table.find(excludedPlayers, string.lower(otherPlayer.Name)) and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local otherCharacter = otherPlayer.Character
            local distance = (player.Character.HumanoidRootPart.Position - otherCharacter.HumanoidRootPart.Position).Magnitude

            if distance <= detectionRadius then
                warn("üö® ‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏£‡πå‡∏õ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Safe Zone...")
                TeleportService:Teleport(133649758958568, player)
                return true
            end
        end
    end
    return false
end

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ TP ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏ü‡πÇ‡∏ã‡∏ô
local function checkPetHealth()
    local pet = player.Character:FindFirstChild("HumanoidRootPart").pet1
    if pet and pet.Stats.Health then
        local healthStat = pet.Stats.Health
        local maxHealthStat = pet.Stats.HealthMax

        if healthStat.Value / maxHealthStat.Value < 0.6 then
            print("‚ö† ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 60% ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö")
            
            -- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
            for i = 1, 5 do
                local args = { [1] = "9566301740688870.6489878", [2] = false }
                game:GetService("Players").LocalPlayer.PlayerGui.CombatClient.CallDigimon:InvokeServer(unpack(args))
                wait(0.1)
            end
            return true -- ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
        end
    end
    return false -- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 60% ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏ï‡πà‡∏≠
end

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏Å‡∏¥‡∏•
local function clickDetectors()
    for _, part in pairs(workspace.Collect:GetChildren()) do
        if part:IsA("Part") and part:FindFirstChild("Health") then
            if part.Health.Value > 0 then
                fireclickdetector(part:FindFirstChildWhichIsA("ClickDetector", true))
            end
        end
    end
end

local function useSkill()
    local args = {
        [1] = 4617,
        [2] = 7,
        [3] = "8359791740798128.694923",
        [4] = false
    }
    game:GetService("Players").LocalPlayer.PlayerGui.CombatClient.Skill2:InvokeServer(unpack(args))
end

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏≤‡∏£‡πå‡∏ï‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡∏´‡πâ‡∏≠‡∏á
local function createPartyAndRestart()
    local args1 = { [1] = "createParty", [2] = "zMaxikax's Party", [3] = 4 }
    ReplicatedStorage.PartySystemRE:FireServer(unpack(args1))
    task.wait(1)

    local args2 = { [1] = "startParty", [2] = "zMaxikax's Party" }
    ReplicatedStorage.PartySystemRE:FireServer(unpack(args2))
    print("‡∏£‡∏µ‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏≤‡∏£‡πå‡∏ï‡∏µ‡πâ‡πÉ‡∏´‡∏°‡πà")
end

-- üìå ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡∏ü‡∏≤‡∏£‡πå‡∏°
local function autoFarm()
    if not checkMapID() then return end  -- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Map ID ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏°

    local startTime = tick()
    local monsterFound = false

    while true do
        monsterFound = false  -- ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏ô loop

        -- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏´‡∏≤‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ô Workspace.Collect
        for _, part in pairs(workspace.Collect:GetChildren()) do
            if part:IsA("Part") and part:FindFirstChild("Health") then
                monsterFound = true
                local pet = player.Character:FindFirstChild("HumanoidRootPart") and player.Character.HumanoidRootPart.pet1
                local playerDigimonHealth = pet and pet.Stats.Health

                -- ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô
                if playerDigimonHealth and playerDigimonHealth.Value < 60 then
                    -- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                    game.Players.LocalPlayer.PlayerGui.CombatClient.CallDigimon:InvokeServer()
                else
                    -- ‡∏™‡πà‡∏á‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏Å‡∏¥‡∏•
                    clickDetectors()
                    useSkill()
                end
                break
            end
        end

        -- ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏´‡πâ‡∏£‡∏µ‡∏´‡πâ‡∏≠‡∏á
        if not monsterFound then
            if tick() - startTime > 10 then
                warn("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏£‡∏µ‡∏´‡πâ‡∏≠‡∏á...")
                createPartyAndRestart()  -- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏≤‡∏£‡πå‡∏ï‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡∏´‡πâ‡∏≠‡∏á
                break
            end
        else
            -- ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï startTime ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå
            startTime = tick()
        end

        -- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
        if checkNearbyPlayers() then
            break
        end
        
        -- ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô
        if checkPetHealth() then
            break
        end

        wait(0.1) -- ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    end
end

-- üìå ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏¥‡∏à‡∏¥‡∏°‡πà‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå
if checkPlayerAndPetReady() then
    -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏±‡∏ô‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏°‡∏û‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    if checkMapID() then
        autoFarm()
    end
end
